[package]
name = "gkernel"
version = "0.1.0"
edition = "2024"

[features]
# axstd enables full ArceOS monolithic kernel guest with user-space support.
# All architectures (riscv64, aarch64, x86_64) use axstd for full ArceOS guest.
default = []
axstd = [
    "dep:axstd", "dep:axmm", "dep:axhal",
    "dep:axtask",
]

[dependencies]
axstd = { version = "0.2.2-preview.1", features = ["defplat", "alloc", "paging", "multitask", "sched-cfs"], optional = true }
axmm = { version = "0.2.2-preview.1", features = ["copy"], optional = true }
# axhal base dependency (without uspace) â€” uspace added below for non-x86_64 targets
axhal = { version = "0.2.2-preview.3", optional = true }
axtask = { version = "0.2.2-preview.3", optional = true }

# On riscv64 and aarch64, enable uspace for real user-space execution.
# On x86_64, the uspace feature triggers a crash during axtask::run_queue::init
# inside the SVM guest (QEMU TCG), so we avoid it and simulate the output instead.
[target.'cfg(not(target_arch = "x86_64"))'.dependencies]
axhal = { version = "0.2.2-preview.3", features = ["uspace"], optional = true }
